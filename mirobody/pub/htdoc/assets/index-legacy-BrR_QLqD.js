System.register(["./index-legacy-BCYsgP_m.js","./vendor-antd-legacy-B_nlExEM.js","./logo-legacy-Dj_BY5C3.js","./account-legacy-4gI0f2zM.js","./RenderHistoryList-legacy-BAKHtsxR.js","./vendor-firebase-legacy-SmJg7pDS.js"],function(e,n){"use strict";var t,s,i,o,a,l,r,d,_,c,g,p,f,x;return{setters:[e=>{t=e.u,s=e.w,i=e.b,o=e.a,a=e.x,l=e.y,r=e.j},e=>{d=e.r},e=>{_=e.S},e=>{c=e.c},e=>{g=e.u,p=e.m,f=e.R,x=e.f},null],execute:function(){var n=document.createElement("style");n.textContent="._shareWrapper_5kgns_1{width:100vw;height:100dvh;display:flex;flex-direction:column;background:#fff;overflow:hidden;position:relative}._content_5kgns_24{flex:1;width:100%;display:flex;position:relative;overflow:hidden}._normalContent_5kgns_32{display:flex;flex-direction:column;flex:1;overflow-y:auto;overflow-x:hidden;padding:32px 24px;container-type:inline-size;container-name:share-content-list}._normalContent_5kgns_32._hidden_5kgns_43{display:none}._fullpageContent_5kgns_47{display:flex;flex-direction:column;flex:1;overflow-y:auto;overflow-x:hidden;padding:16px;justify-content:flex-start;align-items:center}._fullpageContent_5kgns_47>*{max-width:100%;width:100%}._fullpageContent_5kgns_47._hidden_5kgns_43{display:none}._conversationList_5kgns_66{width:100%;padding:32px 24px;display:flex;flex-direction:column;gap:24px;container-type:inline-size;container-name:share-content-list}._errorContainer_5kgns_76{display:flex;align-items:center;justify-content:center;padding:80px 24px}._errorContainer_5kgns_76 ._errorText_5kgns_82{font-size:16px;color:#ec221f;text-align:center}._loadingContainer_5kgns_88{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 0}._loadingContainer_5kgns_88 ._spinner_5kgns_95{width:48px;height:48px;border:4px solid #f0f0f0;border-top:4px solid #1a73e8;border-radius:50%;animation:_spin_5kgns_95 1s linear infinite}._loadingContainer_5kgns_88 ._loadingText_5kgns_103{margin-top:16px;font-size:14px;color:#666}@keyframes _spin_5kgns_95{0%{transform:rotate(0)}to{transform:rotate(360deg)}}._wrapper_5kgns_117{width:100%;flex:1;scroll-behavior:smooth;overflow-y:auto;display:flex;flex-direction:column;align-items:center;padding:18px}._content_list_5kgns_128{width:100%;display:flex;flex-direction:column;gap:12px;max-width:1400px;container-type:inline-size;container-name:content-list}._header_5kgns_11{width:100%;height:64px;display:flex;align-items:center;padding:0 32px;border-bottom:1px solid #e1e3e1;flex-shrink:0}._header_5kgns_11 ._logo_5kgns_20{height:32px}\n/*$vite$:1*/",document.head.appendChild(n),e("default",function(){const{t:e}=t(),{shareSessionId:n}=s(),[u,m]=d.useState(!0),[y,k]=d.useState([]),[v,S]=d.useState(""),[w,C]=d.useState(!1),[j,T]=d.useState(null),N=g(e=>e.getModelShowName),E=g(e=>e.init);d.useEffect(()=>{E()},[]),d.useEffect(()=>{n&&I()},[n]);const I=async()=>{m(!0),S("");try{const{history:e}=await i.getShareContent({share_session_id:n}),t=b(e||[]);k(t)}catch(t){o.error("Fetch share content error:",t),S(e("share_not_found")||"Share link not found or expired")}finally{m(!1)}},b=e=>{const n=[];return e.forEach(e=>{if(e.role===a.USER){const t={role:a.USER,questionId:e.questionId||"",messages:[],id:e.id};switch(e.messageType){case l.FILE:case l.IMAGE:case l.PDF:t.messages=[{...e,type:l.USER_FILE_LIST,content:e.content_dict?.files?.map(e=>({file_key:e.file_key,original_file_type:e.type,file_type:c(e.type),file_name:e.file_name,file_url:e.url_full,file_size:e.file_size}))||[]}];break;case l.TEXT:t.messages=[{...e,type:l.USER_QUESTION}];break;default:t.messages=[{...e,type:e.messageType||l.USER_QUESTION}]}return void n.push(t)}const t={...e,messages:p(e.content_dict||[])},s=n.find(n=>n.question_id===e.questionId&&n.role===a.ASSISTANT);s?s.datasource.push(t):n.push({role:a.ASSISTANT,question_id:e.questionId,datasource:[t],id:e.id})}),n};return r.jsxs("div",{className:h.shareWrapper,children:[r.jsx("div",{className:h.header,children:r.jsx(_,{className:h.logo})}),r.jsxs("div",{className:h.content,children:[r.jsxs("div",{className:`${h.normalContent} ${w?h.hidden:""}`,children:[u&&r.jsxs("div",{className:h.loadingContainer,children:[r.jsx("div",{className:h.spinner}),r.jsx("div",{className:h.loadingText,children:e("loading")})]}),!u&&v&&r.jsx("div",{className:h.errorContainer,children:r.jsx("div",{className:h.errorText,children:v})}),!u&&!v&&y.length>0&&r.jsx("div",{className:h.content_list,children:r.jsx(f,{history_list:y,assistantDialogProps:{isShowFullpage:w,fullpageDatasource:j,onToggleFullpage:e=>{e?(T(e),C(!0)):(T(null),C(!1))}}})})]}),r.jsx("div",{className:`${h.fullpageContent} ${w?"":h.hidden}`,children:w&&j&&r.jsx(x,{datasource:j,isShowFullpage:w,fullpageDatasource:j,onToggleFullpage:e=>{e?(T(e),C(!0)):(T(null),C(!1))},modelShowName:N(j?.provider,j?.agent)})})]})]})});const h={shareWrapper:"_shareWrapper_5kgns_1",header:"_header_5kgns_11",logo:"_logo_5kgns_20",content:"_content_5kgns_24",normalContent:"_normalContent_5kgns_32",hidden:"_hidden_5kgns_43",fullpageContent:"_fullpageContent_5kgns_47",errorContainer:"_errorContainer_5kgns_76",errorText:"_errorText_5kgns_82",loadingContainer:"_loadingContainer_5kgns_88",spinner:"_spinner_5kgns_95",loadingText:"_loadingText_5kgns_103",content_list:"_content_list_5kgns_128"}}}});
